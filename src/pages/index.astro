---
import Layout from "../layouts/Layout.astro";
import Player from "../components/Player";
import InstallSection from "../components/InstallSection.astro";
import UsageSection from "../components/UsageSection.astro";
import Footer from "../components/Footer.astro";

let version = "";
try {
  const res = await fetch("https://api.github.com/repos/olivier-w/climp/releases/latest");
  if (res.ok) {
    const data = await res.json();
    version = data.tag_name;
  }
} catch {}
---

<Layout>
  <main class="min-h-dvh flex flex-col items-center justify-center px-6 py-24 gap-28">
    {/* Tagline */}
    <div class="w-full max-w-[540px] text-center space-y-2">
      <h1 class="text-xl text-balance">
        <a
          href="https://github.com/olivier-w/climp"
          target="_blank"
          rel="noopener noreferrer"
          class="climp-title"
        >climp</a>
        {version && <span class="text-sm text-[var(--color-text-muted)] opacity-40 ml-1">{version}</span>}
      </h1>
      <p class="text-sm text-[var(--color-text-muted)] text-pretty">
        the cli media player nobody asked for.
      </p>
    </div>

    {/* Player in terminal frame */}
    <div class="w-full max-w-[600px]">
      <div class="terminal-window">
        <div class="terminal-titlebar">
          <div class="terminal-dots">
            <span class="terminal-dot terminal-dot--close"></span>
            <span class="terminal-dot terminal-dot--minimize"></span>
            <span class="terminal-dot terminal-dot--maximize"></span>
          </div>
          <span class="terminal-title">climp</span>
          <div class="terminal-dots invisible">
            <span class="terminal-dot"></span>
            <span class="terminal-dot"></span>
            <span class="terminal-dot"></span>
          </div>
        </div>
        <div class="terminal-body">
          <Player client:load />
        </div>
      </div>
    </div>

    {/* Install options */}
    <div class="w-full max-w-[540px] min-w-0">
      <InstallSection />
    </div>

    {/* Usage */}
    <div class="w-full max-w-[540px] min-w-0">
      <UsageSection />
    </div>

    <Footer />
  </main>
</Layout>
