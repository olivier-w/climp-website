---
import Layout from "../layouts/Layout.astro";
import Player from "../components/Player";
import InstallSection from "../components/InstallSection.astro";
import UsageSection from "../components/UsageSection.astro";
import Footer from "../components/Footer.astro";

let version = "";
try {
  const res = await fetch("https://api.github.com/repos/olivier-w/climp/releases/latest");
  if (res.ok) {
    const data = await res.json();
    version = data.tag_name;
  }
} catch {}
---

<Layout>
  <main class="min-h-dvh flex flex-col items-center justify-center px-6 py-24 gap-28">
    {/* Tagline */}
    <div class="w-full max-w-[540px] text-center space-y-2">
      <h1 class="text-xl text-balance">
        <a
          href="https://github.com/olivier-w/climp"
          target="_blank"
          rel="noopener noreferrer"
          class="climp-title"
        >climp</a>
        {version && <span class="text-sm text-text-muted opacity-40 ml-1">{version}</span>}
      </h1>
      <p class="text-sm text-text-muted text-pretty">
        the cli media player nobody asked for.
      </p>
    </div>

    {/* Player in terminal frame */}
    <div class="w-full max-w-[600px]">
      <div class="terminal-window">
        <div class="terminal-titlebar">
          <span class="terminal-title">climp</span>
          <div class="terminal-controls">
            <button class="terminal-control" aria-label="Minimize">
              <svg width="10" height="1" viewBox="0 0 10 1" fill="currentColor">
                <rect width="10" height="1"/>
              </svg>
            </button>
            <button class="terminal-control" aria-label="Maximize">
              <svg width="10" height="10" viewBox="0 0 10 10" fill="none" stroke="currentColor">
                <rect x="0.5" y="0.5" width="9" height="9"/>
              </svg>
            </button>
            <button class="terminal-control terminal-control--close" aria-label="Close">
              <svg width="10" height="10" viewBox="0 0 10 10" stroke="currentColor">
                <path d="M0 0L10 10M10 0L0 10"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="terminal-body">
          <Player client:load />
        </div>
      </div>
    </div>

    {/* Install options */}
    <div class="w-full max-w-[540px] min-w-0">
      <InstallSection />
    </div>

    {/* Usage */}
    <div class="w-full max-w-[540px] min-w-0">
      <UsageSection />
    </div>

    <Footer />
  </main>
</Layout>
